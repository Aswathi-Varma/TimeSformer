Not using distributed mode
[21:23:25.758391] job dir: /root/seg_framework/MS-Mamba/run_scripts
[21:23:25.758531] Namespace(accum_iter=1,
model='SegFormer3D',
in_channels=1,
lr=None,
blr=0.001,
min_lr=0,
dist_on_itp=False,
warmup_epochs=20,
device='cuda:0',
seed=42,
layer_decay=0.75,
clip_grad=None,
num_workers=8,
pin_mem=True,
resume='',
world_size=1,
embed_dim=1,
local_rank=-1,
dist_url='env://',
nb_classes=2,
data_dir='/root/MSLesSeg24/data',
datalist=None,
modalities='T1,T2,FLAIR,T1ce',
preprocess=False,
distributed=False)
[21:23:25.758642] device  cuda:0
[21:23:26.111912] Load pre-trained checkpoint from: /root/seg_framework/MS-Mamba/output_dir/mslesseg/checkpoints_SegFormer3D/checkpoint-best_dice_model.pth
[21:23:26.117294] _IncompatibleKeys(missing_keys=[], unexpected_keys=['encoder.stages.0.0.0.norm1.weight', 'encoder.stages.0.0.0.norm1.bias', 'encoder.stages.0.0.0.mamba.A_log', 'encoder.stages.0.0.0.mamba.D', 'encoder.stages.0.0.0.mamba.A_b_log', 'encoder.stages.0.0.0.mamba.D_b', 'encoder.stages.0.0.0.mamba.A_s_log', 'encoder.stages.0.0.0.mamba.D_s', 'encoder.stages.0.0.0.mamba.in_proj.weight', 'encoder.stages.0.0.0.mamba.conv1d.weight', 'encoder.stages.0.0.0.mamba.conv1d.bias', 'encoder.stages.0.0.0.mamba.x_proj.weight', 'encoder.stages.0.0.0.mamba.dt_proj.weight', 'encoder.stages.0.0.0.mamba.dt_proj.bias', 'encoder.stages.0.0.0.mamba.conv1d_b.weight', 'encoder.stages.0.0.0.mamba.conv1d_b.bias', 'encoder.stages.0.0.0.mamba.x_proj_b.weight', 'encoder.stages.0.0.0.mamba.dt_proj_b.weight', 'encoder.stages.0.0.0.mamba.dt_proj_b.bias', 'encoder.stages.0.0.0.mamba.conv1d_s.weight', 'encoder.stages.0.0.0.mamba.conv1d_s.bias', 'encoder.stages.0.0.0.mamba.x_proj_s.weight', 'encoder.stages.0.0.0.mamba.dt_proj_s.weight', 'encoder.stages.0.0.0.mamba.dt_proj_s.bias', 'encoder.stages.0.0.0.mamba.out_proj.weight', 'encoder.stages.0.0.0.norm2.weight', 'encoder.stages.0.0.0.norm2.bias', 'encoder.stages.0.0.0.mlp.fc1.weight', 'encoder.stages.0.0.0.mlp.fc1.bias', 'encoder.stages.0.0.0.mlp.dwconv.dwconv.conv3d.weight', 'encoder.stages.0.0.0.mlp.dwconv.dwconv.conv3d.bias', 'encoder.stages.0.0.0.mlp.fc2.weight', 'encoder.stages.0.0.0.mlp.fc2.bias', 'encoder.stages.0.1.0.norm1.weight', 'encoder.stages.0.1.0.norm1.bias', 'encoder.stages.0.1.0.mamba.A_log', 'encoder.stages.0.1.0.mamba.D', 'encoder.stages.0.1.0.mamba.A_b_log', 'encoder.stages.0.1.0.mamba.D_b', 'encoder.stages.0.1.0.mamba.A_s_log', 'encoder.stages.0.1.0.mamba.D_s', 'encoder.stages.0.1.0.mamba.in_proj.weight', 'encoder.stages.0.1.0.mamba.conv1d.weight', 'encoder.stages.0.1.0.mamba.conv1d.bias', 'encoder.stages.0.1.0.mamba.x_proj.weight', 'encoder.stages.0.1.0.mamba.dt_proj.weight', 'encoder.stages.0.1.0.mamba.dt_proj.bias', 'encoder.stages.0.1.0.mamba.conv1d_b.weight', 'encoder.stages.0.1.0.mamba.conv1d_b.bias', 'encoder.stages.0.1.0.mamba.x_proj_b.weight', 'encoder.stages.0.1.0.mamba.dt_proj_b.weight', 'encoder.stages.0.1.0.mamba.dt_proj_b.bias', 'encoder.stages.0.1.0.mamba.conv1d_s.weight', 'encoder.stages.0.1.0.mamba.conv1d_s.bias', 'encoder.stages.0.1.0.mamba.x_proj_s.weight', 'encoder.stages.0.1.0.mamba.dt_proj_s.weight', 'encoder.stages.0.1.0.mamba.dt_proj_s.bias', 'encoder.stages.0.1.0.mamba.out_proj.weight', 'encoder.stages.0.1.0.norm2.weight', 'encoder.stages.0.1.0.norm2.bias', 'encoder.stages.0.1.0.mlp.fc1.weight', 'encoder.stages.0.1.0.mlp.fc1.bias', 'encoder.stages.0.1.0.mlp.dwconv.dwconv.conv3d.weight', 'encoder.stages.0.1.0.mlp.dwconv.dwconv.conv3d.bias', 'encoder.stages.0.1.0.mlp.fc2.weight', 'encoder.stages.0.1.0.mlp.fc2.bias', 'encoder.stages.1.0.0.norm1.weight', 'encoder.stages.1.0.0.norm1.bias', 'encoder.stages.1.0.0.mamba.A_log', 'encoder.stages.1.0.0.mamba.D', 'encoder.stages.1.0.0.mamba.A_b_log', 'encoder.stages.1.0.0.mamba.D_b', 'encoder.stages.1.0.0.mamba.A_s_log', 'encoder.stages.1.0.0.mamba.D_s', 'encoder.stages.1.0.0.mamba.in_proj.weight', 'encoder.stages.1.0.0.mamba.conv1d.weight', 'encoder.stages.1.0.0.mamba.conv1d.bias', 'encoder.stages.1.0.0.mamba.x_proj.weight', 'encoder.stages.1.0.0.mamba.dt_proj.weight', 'encoder.stages.1.0.0.mamba.dt_proj.bias', 'encoder.stages.1.0.0.mamba.conv1d_b.weight', 'encoder.stages.1.0.0.mamba.conv1d_b.bias', 'encoder.stages.1.0.0.mamba.x_proj_b.weight', 'encoder.stages.1.0.0.mamba.dt_proj_b.weight', 'encoder.stages.1.0.0.mamba.dt_proj_b.bias', 'encoder.stages.1.0.0.mamba.conv1d_s.weight', 'encoder.stages.1.0.0.mamba.conv1d_s.bias', 'encoder.stages.1.0.0.mamba.x_proj_s.weight', 'encoder.stages.1.0.0.mamba.dt_proj_s.weight', 'encoder.stages.1.0.0.mamba.dt_proj_s.bias', 'encoder.stages.1.0.0.mamba.out_proj.weight', 'encoder.stages.1.0.0.norm2.weight', 'encoder.stages.1.0.0.norm2.bias', 'encoder.stages.1.0.0.mlp.fc1.weight', 'encoder.stages.1.0.0.mlp.fc1.bias', 'encoder.stages.1.0.0.mlp.dwconv.dwconv.conv3d.weight', 'encoder.stages.1.0.0.mlp.dwconv.dwconv.conv3d.bias', 'encoder.stages.1.0.0.mlp.fc2.weight', 'encoder.stages.1.0.0.mlp.fc2.bias', 'encoder.stages.1.1.0.norm1.weight', 'encoder.stages.1.1.0.norm1.bias', 'encoder.stages.1.1.0.mamba.A_log', 'encoder.stages.1.1.0.mamba.D', 'encoder.stages.1.1.0.mamba.A_b_log', 'encoder.stages.1.1.0.mamba.D_b', 'encoder.stages.1.1.0.mamba.A_s_log', 'encoder.stages.1.1.0.mamba.D_s', 'encoder.stages.1.1.0.mamba.in_proj.weight', 'encoder.stages.1.1.0.mamba.conv1d.weight', 'encoder.stages.1.1.0.mamba.conv1d.bias', 'encoder.stages.1.1.0.mamba.x_proj.weight', 'encoder.stages.1.1.0.mamba.dt_proj.weight', 'encoder.stages.1.1.0.mamba.dt_proj.bias', 'encoder.stages.1.1.0.mamba.conv1d_b.weight', 'encoder.stages.1.1.0.mamba.conv1d_b.bias', 'encoder.stages.1.1.0.mamba.x_proj_b.weight', 'encoder.stages.1.1.0.mamba.dt_proj_b.weight', 'encoder.stages.1.1.0.mamba.dt_proj_b.bias', 'encoder.stages.1.1.0.mamba.conv1d_s.weight', 'encoder.stages.1.1.0.mamba.conv1d_s.bias', 'encoder.stages.1.1.0.mamba.x_proj_s.weight', 'encoder.stages.1.1.0.mamba.dt_proj_s.weight', 'encoder.stages.1.1.0.mamba.dt_proj_s.bias', 'encoder.stages.1.1.0.mamba.out_proj.weight', 'encoder.stages.1.1.0.norm2.weight', 'encoder.stages.1.1.0.norm2.bias', 'encoder.stages.1.1.0.mlp.fc1.weight', 'encoder.stages.1.1.0.mlp.fc1.bias', 'encoder.stages.1.1.0.mlp.dwconv.dwconv.conv3d.weight', 'encoder.stages.1.1.0.mlp.dwconv.dwconv.conv3d.bias', 'encoder.stages.1.1.0.mlp.fc2.weight', 'encoder.stages.1.1.0.mlp.fc2.bias', 'encoder.stages.2.0.0.norm1.weight', 'encoder.stages.2.0.0.norm1.bias', 'encoder.stages.2.0.0.mamba.A_log', 'encoder.stages.2.0.0.mamba.D', 'encoder.stages.2.0.0.mamba.A_b_log', 'encoder.stages.2.0.0.mamba.D_b', 'encoder.stages.2.0.0.mamba.A_s_log', 'encoder.stages.2.0.0.mamba.D_s', 'encoder.stages.2.0.0.mamba.in_proj.weight', 'encoder.stages.2.0.0.mamba.conv1d.weight', 'encoder.stages.2.0.0.mamba.conv1d.bias', 'encoder.stages.2.0.0.mamba.x_proj.weight', 'encoder.stages.2.0.0.mamba.dt_proj.weight', 'encoder.stages.2.0.0.mamba.dt_proj.bias', 'encoder.stages.2.0.0.mamba.conv1d_b.weight', 'encoder.stages.2.0.0.mamba.conv1d_b.bias', 'encoder.stages.2.0.0.mamba.x_proj_b.weight', 'encoder.stages.2.0.0.mamba.dt_proj_b.weight', 'encoder.stages.2.0.0.mamba.dt_proj_b.bias', 'encoder.stages.2.0.0.mamba.conv1d_s.weight', 'encoder.stages.2.0.0.mamba.conv1d_s.bias', 'encoder.stages.2.0.0.mamba.x_proj_s.weight', 'encoder.stages.2.0.0.mamba.dt_proj_s.weight', 'encoder.stages.2.0.0.mamba.dt_proj_s.bias', 'encoder.stages.2.0.0.mamba.out_proj.weight', 'encoder.stages.2.0.0.norm2.weight', 'encoder.stages.2.0.0.norm2.bias', 'encoder.stages.2.0.0.mlp.fc1.weight', 'encoder.stages.2.0.0.mlp.fc1.bias', 'encoder.stages.2.0.0.mlp.dwconv.dwconv.conv3d.weight', 'encoder.stages.2.0.0.mlp.dwconv.dwconv.conv3d.bias', 'encoder.stages.2.0.0.mlp.fc2.weight', 'encoder.stages.2.0.0.mlp.fc2.bias', 'encoder.stages.2.1.0.norm1.weight', 'encoder.stages.2.1.0.norm1.bias', 'encoder.stages.2.1.0.mamba.A_log', 'encoder.stages.2.1.0.mamba.D', 'encoder.stages.2.1.0.mamba.A_b_log', 'encoder.stages.2.1.0.mamba.D_b', 'encoder.stages.2.1.0.mamba.A_s_log', 'encoder.stages.2.1.0.mamba.D_s', 'encoder.stages.2.1.0.mamba.in_proj.weight', 'encoder.stages.2.1.0.mamba.conv1d.weight', 'encoder.stages.2.1.0.mamba.conv1d.bias', 'encoder.stages.2.1.0.mamba.x_proj.weight', 'encoder.stages.2.1.0.mamba.dt_proj.weight', 'encoder.stages.2.1.0.mamba.dt_proj.bias', 'encoder.stages.2.1.0.mamba.conv1d_b.weight', 'encoder.stages.2.1.0.mamba.conv1d_b.bias', 'encoder.stages.2.1.0.mamba.x_proj_b.weight', 'encoder.stages.2.1.0.mamba.dt_proj_b.weight', 'encoder.stages.2.1.0.mamba.dt_proj_b.bias', 'encoder.stages.2.1.0.mamba.conv1d_s.weight', 'encoder.stages.2.1.0.mamba.conv1d_s.bias', 'encoder.stages.2.1.0.mamba.x_proj_s.weight', 'encoder.stages.2.1.0.mamba.dt_proj_s.weight', 'encoder.stages.2.1.0.mamba.dt_proj_s.bias', 'encoder.stages.2.1.0.mamba.out_proj.weight', 'encoder.stages.2.1.0.norm2.weight', 'encoder.stages.2.1.0.norm2.bias', 'encoder.stages.2.1.0.mlp.fc1.weight', 'encoder.stages.2.1.0.mlp.fc1.bias', 'encoder.stages.2.1.0.mlp.dwconv.dwconv.conv3d.weight', 'encoder.stages.2.1.0.mlp.dwconv.dwconv.conv3d.bias', 'encoder.stages.2.1.0.mlp.fc2.weight', 'encoder.stages.2.1.0.mlp.fc2.bias', 'encoder.stages.3.0.0.norm1.weight', 'encoder.stages.3.0.0.norm1.bias', 'encoder.stages.3.0.0.mamba.A_log', 'encoder.stages.3.0.0.mamba.D', 'encoder.stages.3.0.0.mamba.A_b_log', 'encoder.stages.3.0.0.mamba.D_b', 'encoder.stages.3.0.0.mamba.A_s_log', 'encoder.stages.3.0.0.mamba.D_s', 'encoder.stages.3.0.0.mamba.in_proj.weight', 'encoder.stages.3.0.0.mamba.conv1d.weight', 'encoder.stages.3.0.0.mamba.conv1d.bias', 'encoder.stages.3.0.0.mamba.x_proj.weight', 'encoder.stages.3.0.0.mamba.dt_proj.weight', 'encoder.stages.3.0.0.mamba.dt_proj.bias', 'encoder.stages.3.0.0.mamba.conv1d_b.weight', 'encoder.stages.3.0.0.mamba.conv1d_b.bias', 'encoder.stages.3.0.0.mamba.x_proj_b.weight', 'encoder.stages.3.0.0.mamba.dt_proj_b.weight', 'encoder.stages.3.0.0.mamba.dt_proj_b.bias', 'encoder.stages.3.0.0.mamba.conv1d_s.weight', 'encoder.stages.3.0.0.mamba.conv1d_s.bias', 'encoder.stages.3.0.0.mamba.x_proj_s.weight', 'encoder.stages.3.0.0.mamba.dt_proj_s.weight', 'encoder.stages.3.0.0.mamba.dt_proj_s.bias', 'encoder.stages.3.0.0.mamba.out_proj.weight', 'encoder.stages.3.0.0.norm2.weight', 'encoder.stages.3.0.0.norm2.bias', 'encoder.stages.3.0.0.mlp.fc1.weight', 'encoder.stages.3.0.0.mlp.fc1.bias', 'encoder.stages.3.0.0.mlp.dwconv.dwconv.conv3d.weight', 'encoder.stages.3.0.0.mlp.dwconv.dwconv.conv3d.bias', 'encoder.stages.3.0.0.mlp.fc2.weight', 'encoder.stages.3.0.0.mlp.fc2.bias', 'encoder.stages.3.1.0.norm1.weight', 'encoder.stages.3.1.0.norm1.bias', 'encoder.stages.3.1.0.mamba.A_log', 'encoder.stages.3.1.0.mamba.D', 'encoder.stages.3.1.0.mamba.A_b_log', 'encoder.stages.3.1.0.mamba.D_b', 'encoder.stages.3.1.0.mamba.A_s_log', 'encoder.stages.3.1.0.mamba.D_s', 'encoder.stages.3.1.0.mamba.in_proj.weight', 'encoder.stages.3.1.0.mamba.conv1d.weight', 'encoder.stages.3.1.0.mamba.conv1d.bias', 'encoder.stages.3.1.0.mamba.x_proj.weight', 'encoder.stages.3.1.0.mamba.dt_proj.weight', 'encoder.stages.3.1.0.mamba.dt_proj.bias', 'encoder.stages.3.1.0.mamba.conv1d_b.weight', 'encoder.stages.3.1.0.mamba.conv1d_b.bias', 'encoder.stages.3.1.0.mamba.x_proj_b.weight', 'encoder.stages.3.1.0.mamba.dt_proj_b.weight', 'encoder.stages.3.1.0.mamba.dt_proj_b.bias', 'encoder.stages.3.1.0.mamba.conv1d_s.weight', 'encoder.stages.3.1.0.mamba.conv1d_s.bias', 'encoder.stages.3.1.0.mamba.x_proj_s.weight', 'encoder.stages.3.1.0.mamba.dt_proj_s.weight', 'encoder.stages.3.1.0.mamba.dt_proj_s.bias', 'encoder.stages.3.1.0.mamba.out_proj.weight', 'encoder.stages.3.1.0.norm2.weight', 'encoder.stages.3.1.0.norm2.bias', 'encoder.stages.3.1.0.mlp.fc1.weight', 'encoder.stages.3.1.0.mlp.fc1.bias', 'encoder.stages.3.1.0.mlp.dwconv.dwconv.conv3d.weight', 'encoder.stages.3.1.0.mlp.dwconv.dwconv.conv3d.bias', 'encoder.stages.3.1.0.mlp.fc2.weight', 'encoder.stages.3.1.0.mlp.fc2.bias'])
[21:23:35.213172] Test:  [0/9]  eta: 0:01:17  loss: 4.3896 (4.3896)  time: 8.5968  data: 5.8491  max mem: 6550
/root/anaconda3/envs/vivim/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
[21:23:39.390390] Test:  [8/9]  eta: 0:00:01  loss: 4.2872 (4.2807)  time: 1.4193  data: 0.6499  max mem: 7167
[21:23:39.419912] Test: Total time: 0:00:12 (1.4227 s / it)
[21:23:41.899511] Scores of the network on the test images: {'loss': 4.28067504035102, 'prec': 0.0031048806849867105, 'rec': 0.6913391351699829, 'dice': 0.006181997247040272}